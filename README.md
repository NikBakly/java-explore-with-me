# java-explore-with-me

## Дипломный проект java-explore-with-me
В данном приложении пользователи могут создавать различные события кино, выставки и т.п.
Можно выбирать события из подборок и оставлять заявку на посещение. В приложении реализован сбор статистики
по просмотрам события, чтобы можно было анализировать самые популярные.

Приложение состоит из двух сервисов:
1. Основной сервис — содержит всё необходимое для работы продукта.
2. Сервис статистики — хранит количество просмотров и позволяет делать различные выборки для анализа работы приложения.

### Основной сервис
API основного сервиса разделите на три части. Первая — публичная, доступна без регистрации любому пользователю сети.
Вторая — закрытая, доступна только авторизованным пользователям. Третья — административная, для администраторов сервиса.
К каждой из частей свои требования.

#### Требования к публичному API
Публичный API должен предоставлять возможности поиска и фильтрации событий.
1. Сортировка списка событий должна быть организована либо по количеству просмотров, которое должно запрашиваться в сервисе статистики, либо по датам событий.
2. При просмотре списка событий возвращается только краткая информация о мероприятиях.
3. Просмотр подробной информации о конкретном событии нужно настроить отдельно (через отдельный эндпоинт).
4. Каждое событие должно относиться к какой-то из закреплённых в приложении категорий.
5. Должна быть настроена возможность получения всех имеющихся категорий и подборок событий (такие подборки будут составлять администраторы ресурса).
6. Каждый публичный запрос для получения списка событий или полной информации о мероприятии должен фиксироваться сервисом статистики.

#### Требования к API для авторизованных пользователей
Закрытая часть API призвана реализовать возможности зарегистрированных пользователей продукта.
1. Авторизованные пользователи должны иметь возможность добавлять в приложение новые мероприятия, редактировать их и просматривать после добавления.
2. Должна быть настроена подача заявок на участие в интересующих мероприятиях.
3. Создатель мероприятия должен иметь возможность подтверждать заявки, которые отправили другие пользователи сервиса.

#### Требования к API для администратора
Административная часть API должна предоставлять возможности настройки и поддержки работы сервиса.
1. Нужно настроить добавление, изменение и удаление категорий для событий.
2. Должна появиться возможность добавлять, удалять и закреплять на главной странице подборки мероприятий.
3. Требуется наладить модерацию событий, размещённых пользователями, — публикация или отклонение.
4. Также должно быть настроено управление пользователями — добавление, просмотр и удаление.

### Сервис статистики
Он призван собирать информацию. Во-первых, о количестве обращений пользователей к спискам событий и, во-вторых,
о количестве запросов к подробной информации о событии.
На основе этой информации должна формироваться статистика о работе приложения.

Функционал сервиса статистики должен содержать:
* запись информации о том, что был обработан запрос к эндпоинту API;
* предоставление статистики за выбранные даты по выбранному эндпоинту.

Чтобы можно было использовать сервис статистики, нужно разработать HTTP-клиент.
Был разработан HTTP-клиент, который входит в состав RestTemplate, входящий в состав Spring Framework.

### Модель данных
Жизненный цикл события должен включать несколько этапов.
1. Создание
2. Ожидание публикации. В статус ожидания публикации событие переходит сразу после создания.
3. Публикация. В это состояние событие переводит администратор.
4. Отмена публикации. В это состояние событие переходит в двух случаях. Первый — если администратор решил, что его нельзя публиковать. Второй — когда инициатор события решил отменить его на этапе ожидания публикации.


#### Аутентификация и авторизация
Оба сервиса ExploreWithMe работают за VPN. С внешним миром их связывает гейтвей.
Он контактирует с системой аутентификации и авторизации, а затем перенаправляет запрос в сервисы.
То есть, если гейтвей пропустил запрос к закрытой или административной части API, значит этот 
запрос успешно прошел аутентификацию и авторизацию.

## Спецификация API
Для обоих сервисов мы разработали подробную спецификацию API:
1. [спецификация основного сервиса](https://raw.githubusercontent.com/yandex-praktikum/java-explore-with-me/main/ewm-main-service-spec.json)
2. [спецификация сервиса статистики](https://raw.githubusercontent.com/yandex-praktikum/java-explore-with-me/main/ewm-stats-service-spec.json)

Для работы со спецификациями вам понадобится редактор [Swagger](https://editor-next.swagger.io/). 

## Запуск проекта
Файла docker-compose.yml был создан специально для удобной сборки и запуска проекта.
Шаги для запуска приложения с помощью docker:
1. Установить docker на свой компьютер. Установить можно по [ссылке](https://docs.docker.com/engine/install/);
2. Упаковать наш код с помощью maven: `mvn package`;
3. Собрать и запустить docker-compose: `docker-compose up`.

